<head>
<script src="jquery1.3.2.js"></script>
<script src="socket.io.min.js"></script>

<script>
    function Updata(data){
		$("#log").text(data.name + ".." + data.position.x.toString() + "..." + data.position.y.toString());
	}
	var socket = io.connect('http://localhost',{port:8080});
	//socket.on('connect', function (socket) {
		socket.on('add', function(data){
			Updata(data);
		});
	//});
	function Join(){
		var user = {};
		user.name = $("#name").val();		
		socket.emit('new', user);
	}
	
		
	socket.on("move", function (data) {
		doMove(data);
	})


	$(document).keydown(function(event){
		switch (event.keyCode) {
			case 37:
				move("left");
				break;
			case 38:
				move("up");
				break;
			case 39:
				move("right");
				break;
			case 40:
				move("down");
				break;
		}
	});

	function move(dir) {
		var data = {};
		data.dir = dir;
		socket.emit("move", data);
	}

	function doMove(dir) {
		$("#dir").text(dir.name + "..." + dir.position.x + "..." + dir.position.y);
	}
</script>
</head>
<body>
<div>
	<input id="name" type="text" name="username"/>
	<button type="button" onclick="Join()">Join</button>
	<div id="log">test</div>
	<div id="dir">test</div>
</div>	
</body>